<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRBP Employment Change Guidance Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #2d3748;
            line-height: 1.6;
        }

        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-section h1 {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .header-section p {
            font-size: 1.2rem;
            color: #64748b;
            max-width: 800px;
            margin: 0 auto;
        }

        .wizard-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }

        .wizard-header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 25px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .wizard-title {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .progress-indicator {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .step-indicator {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .step-indicator.completed {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }

        .step-indicator.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
            transform: scale(1.1);
        }

        .step-indicator.pending {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.7);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .step-connector {
            width: 20px;
            height: 3px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .step-connector.completed {
            background: #10b981;
        }

        .wizard-content {
            padding: 40px;
        }

        .step-section {
            display: none;
        }

        .step-section.active {
            display: block;
        }

        .step-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .step-header h2 {
            font-size: 1.8rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .step-header p {
            color: #64748b;
            font-size: 1.1rem;
        }

        .help-tooltip {
            position: relative;
            display: inline-block;
            margin-left: 8px;
            cursor: help;
        }

        .help-icon {
            width: 18px;
            height: 18px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .tooltip-content {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.85rem;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            max-width: 300px;
            white-space: normal;
            width: max-content;
        }

        .help-tooltip:hover .tooltip-content {
            opacity: 1;
            visibility: visible;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            border: 2px solid #e2e8f0;
        }

        .form-section label {
            display: flex;
            align-items: center;
            font-weight: 600;
            margin-bottom: 15px;
            color: #374151;
            font-size: 1rem;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .country-selection {
            max-height: 250px;
            overflow-y: auto;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: white;
        }

        .country-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid #f1f5f9;
        }

        .country-option:hover {
            background: #f8fafc;
        }

        .country-option.selected {
            background: #eff6ff;
            border-color: #bfdbfe;
        }

        .country-flag {
            font-size: 1.5rem;
        }

        .country-info {
            flex: 1;
        }

        .country-name {
            font-weight: 600;
            color: #1e293b;
        }

        .country-laws {
            font-size: 0.85rem;
            color: #64748b;
        }

        .change-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .change-type-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .change-type-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .change-type-card.selected {
            border-color: #667eea;
            background: #eff6ff;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .change-type-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 15px;
        }

        .change-type-icon {
            font-size: 1.8rem;
        }

        .change-type-details {
            flex: 1;
        }

        .change-type-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .change-type-meta {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 10px;
        }

        .risk-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .risk-low { background: #dcfce7; color: #166534; }
        .risk-medium { background: #fef3c7; color: #92400e; }
        .risk-high { background: #fee2e2; color: #991b1b; }

        .sla-badge {
            background: #e0f2fe;
            color: #0c4a6e;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .change-type-description {
            color: #64748b;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .selection-checkbox {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 20px;
            height: 20px;
        }

        .impact-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            border: 2px solid #e2e8f0;
            text-align: center;
        }

        .impact-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .counter-btn {
            width: 45px;
            height: 45px;
            border: none;
            background: #667eea;
            color: white;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .counter-btn:hover {
            background: #5a67d8;
            transform: scale(1.05);
        }

        .counter-display {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
            min-width: 120px;
        }

        .country-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .country-impact-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e2e8f0;
        }

        .country-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .country-header h4 {
            font-weight: 600;
            color: #1e293b;
            flex: 1;
        }

        .country-counter {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .country-counter-btn {
            width: 30px;
            height: 30px;
            border: none;
            background: #667eea;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .country-count-display {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e293b;
            min-width: 40px;
            text-align: center;
        }

        .country-risk-summary {
            margin-top: 15px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            padding: 30px 40px;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .nav-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .nav-btn-secondary {
            background: #e2e8f0;
            color: #64748b;
        }

        .nav-btn-secondary:hover {
            background: #cbd5e1;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results-preview {
            background: white;
            border-radius: 12px;
            padding: 25px;
            border: 2px solid #e2e8f0;
            margin-top: 20px;
        }

        .preview-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: #1e293b;
            font-weight: 600;
        }

        .preview-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .preview-tag {
            background: #eff6ff;
            color: #1e40af;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            border: 1px solid #bfdbfe;
        }

        .alert-callout {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .alert-icon {
            font-size: 1.5rem;
            margin-top: 2px;
        }

        .results-container {
            margin-top: 30px;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            text-align: center;
        }

        .summary-card h3 {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-card .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
        }

        .country-results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .country-result-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            border: 2px solid #e2e8f0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .country-result-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .country-result-title {
            flex: 1;
            font-weight: 600;
            color: #1e293b;
            font-size: 1.1rem;
        }

        .country-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .country-stat {
            text-align: center;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .country-stat-label {
            font-size: 0.8rem;
            color: #64748b;
            margin-bottom: 4px;
        }

        .country-stat-value {
            font-weight: 600;
            color: #1e293b;
        }

        @media (max-width: 768px) {
            .header-section h1 {
                font-size: 2rem;
            }
            
            .wizard-content {
                padding: 20px;
            }
            
            .form-grid, .country-breakdown, .country-results-grid {
                grid-template-columns: 1fr;
            }
            
            .change-types-grid {
                grid-template-columns: 1fr;
            }

            .progress-indicator {
                gap: 8px;
            }

            .step-connector {
                width: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header-section">
            <h1>HRBP Employment Change Guidance</h1>
            <p>Comprehensive legal guidance and compliance assessment for employment changes. Please use the configuration options to best describe your change scenario</p>
        </div>

        <div class="wizard-container">
            <div class="wizard-header">
                <div class="wizard-title">
                    <span>🧭</span>
                    <span id="wizardTitle">Step 1: Select Countries</span>
                </div>
                <div class="progress-indicator">
                    <div class="step-indicator active" id="step1">1</div>
                    <div class="step-connector" id="connector1"></div>
                    <div class="step-indicator pending" id="step2">2</div>
                    <div class="step-connector" id="connector2"></div>
                    <div class="step-indicator pending" id="step3">3</div>
                    <div class="step-connector" id="connector3"></div>
                    <div class="step-indicator pending" id="step4">4</div>
                </div>
            </div>

            <div class="wizard-content">
                <!-- Step 1: Country Selection -->
                <div class="step-section active" id="stepCountries">
                    <div class="step-header">
                        <h2>Select Jurisdictions 🌍</h2>
                        <p>Choose the countries where employment changes will take place. Different countries have varying legal requirements and processes.</p>
                    </div>

                    <div class="form-section">
                        <label>
                            Available Jurisdictions
                            <div class="help-tooltip">
                                <div class="help-icon">?</div>
                                <div class="tooltip-content">
                                    Select all countries where you plan to implement employment changes. Each country has different employment laws, notice requirements, and compliance obligations.
                                </div>
                            </div>
                        </label>
                        <div class="country-selection" id="countrySelection">
                            <!-- Countries will be populated here -->
                        </div>
                    </div>

                    <div id="countryPreview" class="results-preview" style="display: none;">
                        <div class="preview-header">
                            <span>📍</span>
                            <span>Selected Jurisdictions:</span>
                        </div>
                        <div class="preview-items" id="selectedCountriesPreview">
                            <!-- Selected countries will appear here -->
                        </div>
                    </div>
                </div>

                <!-- Step 2: Change Types -->
                <div class="step-section" id="stepChangeTypes">
                    <div class="step-header">
                        <h2>Select Change Types 📋</h2>
                        <p>Choose the employment changes you plan to implement. You can select multiple change types for complex scenarios.</p>
                    </div>

                    <div class="change-types-grid" id="changeTypesGrid">
                        <!-- Change types will be populated here -->
                    </div>

                    <div id="changeTypesPreview" class="results-preview" style="display: none;">
                        <div class="preview-header">
                            <span>🔄</span>
                            <span>Selected Change Types:</span>
                        </div>
                        <div class="preview-items" id="selectedChangesPreview">
                            <!-- Selected changes will appear here -->
                        </div>
                    </div>
                </div>

                <!-- Step 3: Impact Assessment -->
                <div class="step-section" id="stepImpact">
                    <div class="step-header">
                        <h2>Associate Impact Assessment 👥</h2>
                        <p>Specify how many associates are affected in each country. This helps determine country-specific compliance requirements.</p>
                    </div>

                    <div class="form-grid">
                        <div class="impact-section">
                            <label>
                                Total Associates Impacted
                                <div class="help-tooltip">
                                    <div class="help-icon">?</div>
                                    <div class="tooltip-content">
                                        Total number of associates affected across all selected countries and change types. Numbers ≥50 may trigger additional legal requirements like WARN Act notices.
                                    </div>
                                </div>
                            </label>
                            <div class="impact-counter">
                                <button type="button" class="counter-btn" onclick="adjustTotalCount(-1)">−</button>
                                <div class="counter-display" id="totalAssociateCount">1</div>
                                <button type="button" class="counter-btn" onclick="adjustTotalCount(1)">+</button>
                            </div>
                            <p style="color: #64748b; font-size: 0.9rem; margin-top: 10px;">
                                Use the buttons or click the number to edit directly
                            </p>
                        </div>

                        <div class="form-section">
                            <label>
                                Implementation Timeline
                                <div class="help-tooltip">
                                    <div class="help-icon">?</div>
                                    <div class="tooltip-content">
                                        When do you plan to implement these changes? This affects notice requirements and planning timelines.
                                    </div>
                                </div>
                            </label>
                            <select class="form-input" id="timeline">
                                <option value="immediate">Immediate (within 30 days)</option>
                                <option value="short">Short term (1-3 months)</option>
                                <option value="medium">Medium term (3-6 months)</option>
                                <option value="long">Long term (6+ months)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-section">
                        <label>
                            Associates by Country
                            <div class="help-tooltip">
                                <div class="help-icon">?</div>
                                <div class="tooltip-content">
                                    Distribute the total number of associates across your selected countries. This helps assess country-specific risks and compliance requirements.
                                </div>
                            </div>
                        </label>
                        <div class="country-breakdown" id="countryBreakdown">
                            <!-- Country breakdown will be populated here -->
                        </div>
                    </div>

                    <div id="impactAlerts"></div>
                </div>

                <!-- Step 4: Results -->
                <div class="step-section" id="stepResults">
                    <div class="step-header">
                        <h2>Comprehensive Guidance Report 📊</h2>
                        <p>Review your customized employment change guidance based on your specific scenario.</p>
                    </div>

                    <div class="results-container" id="finalResults">
                        <!-- Results will be populated here -->
                    </div>
                </div>
            </div>

            <div class="navigation-buttons">
                <button type="button" class="nav-btn nav-btn-secondary" id="prevBtn" onclick="previousStep()" disabled>
                    ← Previous
                </button>
                <button type="button" class="nav-btn nav-btn-primary" id="nextBtn" onclick="nextStep()">
                    Next →
                </button>
            </div>
        </div>
    </div>

    <script>
        // Enhanced data with multi-country support
        const countries = [
            {
                code: 'US',
                name: 'United States',
                flag: '🇺🇸',
                laws: 'FLSA, WARN Act, EEOC, State Employment Laws',
                complexity: 'High - Federal + State + Local laws'
            },
            {
                code: 'UK',
                name: 'United Kingdom',
                flag: '🇬🇧',
                laws: 'Employment Rights Act, TUPE, ACAS Guidelines',
                complexity: 'Medium - National employment law framework'
            },
            {
                code: 'CA',
                name: 'Canada',
                flag: '🇨🇦',
                laws: 'Canada Labour Code, Provincial Employment Standards',
                complexity: 'Medium - Federal + Provincial laws'
            },
            {
                code: 'AU',
                name: 'Australia',
                flag: '🇦🇺',
                laws: 'Fair Work Act, Modern Awards, Enterprise Agreements',
                complexity: 'Medium - Federal framework with state variations'
            },
            {
                code: 'DE',
                name: 'Germany',
                flag: '🇩🇪',
                laws: 'German Civil Code, Works Council Laws, EU Directives',
                complexity: 'High - Complex employment protection laws'
            },
            {
                code: 'FR',
                name: 'France',
                flag: '🇫🇷',
                laws: 'Labour Code, Collective Bargaining Agreements',
                complexity: 'High - Strict employment protection'
            },
            {
                code: 'JP',
                name: 'Japan',
                flag: '🇯🇵',
                laws: 'Labor Standards Act, Employment Security Act',
                complexity: 'Medium - Traditional employment practices'
            },
            {
                code: 'SG',
                name: 'Singapore',
                flag: '🇸🇬',
                laws: 'Employment Act, Industrial Relations Act',
                complexity: 'Low-Medium - Business-friendly framework'
            }
        ];

        const employmentChanges = [
            {
                type: "Manager or Reporting Line Change",
                riskLevel: "Low",
                icon: "👥",
                description: "Changes to direct reporting relationships or organizational hierarchy",
                guidance: {
                    US: { canProceed: true, partner: "HRBP + Business", slaDays: 2, riskLevel: "Low" },
                    UK: { canProceed: true, partner: "HRBP + Business", slaDays: 5, riskLevel: "Low" },
                    CA: { canProceed: true, partner: "HRBP + Business", slaDays: 3, riskLevel: "Low" },
                    AU: { canProceed: true, partner: "HRBP + Business", slaDays: 4, riskLevel: "Low" },
                    DE: { canProceed: false, partner: "HRBP + Works Council + Legal", slaDays: 14, riskLevel: "Medium" },
                    FR: { canProceed: false, partner: "HRBP + Employee Representative", slaDays: 12, riskLevel: "Medium" },
                    JP: { canProceed: true, partner: "HRBP + Business", slaDays: 7, riskLevel: "Low" },
                    SG: { canProceed: true, partner: "HRBP + Business", slaDays: 2, riskLevel: "Low" }
                }
            },
            {
                type: "Job Grade Reduction – Demotion",
                riskLevel: "High",
                icon: "📉",
                description: "Reduction in job level, responsibilities, or grade classification",
                guidance: {
                    US: { canProceed: false, partner: "HRBP + Legal + Compensation", slaDays: 10, riskLevel: "Medium" },
                    UK: { canProceed: false, partner: "HRBP + Legal + Employee Representative", slaDays: 21, riskLevel: "High" },
                    CA: { canProceed: false, partner: "HRBP + Legal + Provincial Authority", slaDays: 14, riskLevel: "High" },
                    AU: { canProceed: false, partner: "HRBP + Legal + Fair Work", slaDays: 18, riskLevel: "High" },
                    DE: { canProceed: false, partner: "HRBP + Works Council + Legal", slaDays: 30, riskLevel: "High" },
                    FR: { canProceed: false, partner: "HRBP + Legal + Labour Inspector", slaDays: 35, riskLevel: "High" },
                    JP: { canProceed: false, partner: "HRBP + Legal + Labour Standards", slaDays: 25, riskLevel: "High" },
                    SG: { canProceed: false, partner: "HRBP + Legal + MOM", slaDays: 12, riskLevel: "Medium" }
                }
            },
            {
                type: "Change Associate's Work Location",
                riskLevel: "High",
                icon: "📍",
                description: "Relocation of associates to different office locations or regions",
                guidance: {
                    US: { canProceed: false, partner: "HRBP + Legal + Relocation Services", slaDays: 20, riskLevel: "Medium" },
                    UK: { canProceed: false, partner: "HRBP + Legal + Employee Representative", slaDays: 30, riskLevel: "High" },
                    CA: { canProceed: false, partner: "HRBP + Legal + Provincial Authority", slaDays: 25, riskLevel: "High" },
                    AU: { canProceed: false, partner: "HRBP + Legal + Fair Work", slaDays: 28, riskLevel: "High" },
                    DE: { canProceed: false, partner: "HRBP + Works Council + Legal + Employee", slaDays: 45, riskLevel: "High" },
                    FR: { canProceed: false, partner: "HRBP + Legal + Employee Representative", slaDays: 40, riskLevel: "High" },
                    JP: { canProceed: false, partner: "HRBP + Legal + Labour Standards", slaDays: 35, riskLevel: "High" },
                    SG: { canProceed: false, partner: "HRBP + Legal + MOM", slaDays: 15, riskLevel: "Medium" }
                }
            },
            {
                type: "Involuntary Reduction in Force (RIF)",
                riskLevel: "High",
                icon: "⚠️",
                description: "Involuntary termination of multiple associates due to business needs",
                guidance: {
                    US: { canProceed: false, partner: "HRBP + Legal + Compliance + Benefits", slaDays: 30, riskLevel: "High" },
                    UK: { canProceed: false, partner: "HRBP + Legal + Employee Representatives + Government", slaDays: 45, riskLevel: "High" },
                    CA: { canProceed: false, partner: "HRBP + Legal + Provincial Authority + Union", slaDays: 35, riskLevel: "High" },
                    AU: { canProceed: false, partner: "HRBP + Legal + Fair Work + Union", slaDays: 40, riskLevel: "High" },
                    DE: { canProceed: false, partner: "HRBP + Works Council + Legal + Federal Agency", slaDays: 60, riskLevel: "High" },
                    FR: { canProceed: false, partner: "HRBP + Legal + Labour Inspector + Union", slaDays: 55, riskLevel: "High" },
                    JP: { canProceed: false, partner: "HRBP + Legal + Labour Standards + Union", slaDays: 50, riskLevel: "High" },
                    SG: { canProceed: false, partner: "HRBP + Legal + MOM + Union", slaDays: 25, riskLevel: "High" }
                }
            },
            {
                type: "Change Associate's Work Hours",
                riskLevel: "Medium",
                icon: "🕐",
                description: "Modification of working time, shift patterns, or schedule arrangements",
                guidance: {
                    US: { canProceed: false, partner: "HRBP + Legal + Compensation", slaDays: 15, riskLevel: "Medium" },
                    UK: { canProceed: false, partner: "HRBP + Legal + Employee Representative", slaDays: 21, riskLevel: "Medium" },
                    CA: { canProceed: false, partner: "HRBP + Legal + Provincial Authority", slaDays: 18, riskLevel: "Medium" },
                    AU: { canProceed: false, partner: "HRBP + Legal + Fair Work", slaDays: 20, riskLevel: "Medium" },
                    DE: { canProceed: false, partner: "HRBP + Works Council + Legal", slaDays: 25, riskLevel: "High" },
                    FR: { canProceed: false, partner: "HRBP + Legal + Employee Representative", slaDays: 22, riskLevel: "Medium" },
                    JP: { canProceed: false, partner: "HRBP + Legal + Labour Standards", slaDays: 20, riskLevel: "Medium" },
                    SG: { canProceed: false, partner: "HRBP + Legal + MOM", slaDays: 10, riskLevel: "Low" }
                }
            }
        ];

        // Wizard state management
        let currentStep = 1;
        let selectedCountries = new Set();
        let selectedChangeTypes = new Set();
        let totalAssociateCount = 1;
        let countryAssociateCounts = {};

        function initializeApp() {
            populateCountries();
            populateChangeTypes();
            updateNavigation();
        }

        function populateCountries() {
            const container = document.getElementById('countrySelection');
            container.innerHTML = '';
            
            countries.forEach(country => {
                const option = document.createElement('div');
                option.className = 'country-option';
                option.onclick = () => toggleCountry(country.code, option);
                
                option.innerHTML = `
                    <span class="country-flag">${country.flag}</span>
                    <div class="country-info">
                        <div class="country-name">${country.name}</div>
                        <div class="country-laws">${country.laws}</div>
                    </div>
                    <input type="checkbox" style="margin-left: auto;">
                `;
                
                container.appendChild(option);
            });
        }

        function populateChangeTypes() {
            const container = document.getElementById('changeTypesGrid');
            container.innerHTML = '';
            
            employmentChanges.forEach((change, index) => {
                const card = document.createElement('div');
                card.className = 'change-type-card';
                card.onclick = () => toggleChangeType(change.type, card);
                
                card.innerHTML = `
                    <input type="checkbox" class="selection-checkbox" id="change-${index}">
                    <div class="change-type-header">
                        <div class="change-type-icon">${change.icon}</div>
                        <div class="change-type-details">
                            <div class="change-type-title">${change.type}</div>
                            <div class="change-type-meta">
                                <span class="risk-badge risk-${change.riskLevel.toLowerCase()}">${change.riskLevel} Risk</span>
                                <span class="sla-badge">Up to 60 days</span>
                            </div>
                        </div>
                    </div>
                    <div class="change-type-description">${change.description}</div>
                `;
                
                container.appendChild(card);
            });
        }

        function toggleCountry(countryCode, element) {
            const checkbox = element.querySelector('input[type="checkbox"]');
            
            if (selectedCountries.has(countryCode)) {
                selectedCountries.delete(countryCode);
                element.classList.remove('selected');
                checkbox.checked = false;
                delete countryAssociateCounts[countryCode];
            } else {
                selectedCountries.add(countryCode);
                element.classList.add('selected');
                checkbox.checked = true;
                countryAssociateCounts[countryCode] = 1;
            }
            
            updateCountryPreview();
            updateNavigation();
        }

        function toggleChangeType(changeType, element) {
            const checkbox = element.querySelector('input[type="checkbox"]');
            
            if (selectedChangeTypes.has(changeType)) {
                selectedChangeTypes.delete(changeType);
                element.classList.remove('selected');
                checkbox.checked = false;
            } else {
                selectedChangeTypes.add(changeType);
                element.classList.add('selected');
                checkbox.checked = true;
            }
            
            updateChangeTypesPreview();
            updateNavigation();
        }

        function updateCountryPreview() {
            const preview = document.getElementById('countryPreview');
            const container = document.getElementById('selectedCountriesPreview');
            
            if (selectedCountries.size > 0) {
                preview.style.display = 'block';
                container.innerHTML = '';
                
                selectedCountries.forEach(countryCode => {
                    const country = countries.find(c => c.code === countryCode);
                    const tag = document.createElement('div');
                    tag.className = 'preview-tag';
                    tag.innerHTML = `${country.flag} ${country.name}`;
                    container.appendChild(tag);
                });
            } else {
                preview.style.display = 'none';
            }
        }

        function updateChangeTypesPreview() {
            const preview = document.getElementById('changeTypesPreview');
            const container = document.getElementById('selectedChangesPreview');
            
            if (selectedChangeTypes.size > 0) {
                preview.style.display = 'block';
                container.innerHTML = '';
                
                selectedChangeTypes.forEach(changeType => {
                    const change = employmentChanges.find(c => c.type === changeType);
                    const tag = document.createElement('div');
                    tag.className = 'preview-tag';
                    tag.innerHTML = `${change.icon} ${change.type}`;
                    container.appendChild(tag);
                });
            } else {
                preview.style.display = 'none';
            }
        }

        function populateCountryBreakdown() {
            const container = document.getElementById('countryBreakdown');
            container.innerHTML = '';
            
            selectedCountries.forEach(countryCode => {
                const country = countries.find(c => c.code === countryCode);
                const card = document.createElement('div');
                card.className = 'country-impact-card';
                
                // Calculate risk for this country based on selected change types
                const countryRisks = Array.from(selectedChangeTypes).map(changeType => {
                    const change = employmentChanges.find(c => c.type === changeType);
                    return change.guidance[countryCode]?.riskLevel || 'Low';
                });
                
                const overallRisk = countryRisks.includes('High') ? 'High' : 
                                 countryRisks.includes('Medium') ? 'Medium' : 'Low';
                
                card.innerHTML = `
                    <div class="country-header">
                        <span class="country-flag">${country.flag}</span>
                        <h4>${country.name}</h4>
                        <span class="risk-badge risk-${overallRisk.toLowerCase()}">${overallRisk}</span>
                    </div>
                    <div class="country-counter">
                        <button type="button" class="country-counter-btn" onclick="adjustCountryCount('${countryCode}', -1)">−</button>
                        <div class="country-count-display" id="count-${countryCode}">${countryAssociateCounts[countryCode] || 1}</div>
                        <button type="button" class="country-counter-btn" onclick="adjustCountryCount('${countryCode}', 1)">+</button>
                    </div>
                    <div class="country-risk-summary">
                        <strong>Risk Level:</strong> ${overallRisk}<br>
                        <strong>Max SLA:</strong> ${getMaxSLAForCountry(countryCode)} days
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function getMaxSLAForCountry(countryCode) {
            let maxSLA = 0;
            selectedChangeTypes.forEach(changeType => {
                const change = employmentChanges.find(c => c.type === changeType);
                if (change.guidance[countryCode]) {
                    maxSLA = Math.max(maxSLA, change.guidance[countryCode].slaDays);
                }
            });
            return maxSLA || 30;
        }

        function adjustTotalCount(delta) {
            totalAssociateCount = Math.max(1, Math.min(10000, totalAssociateCount + delta));
            document.getElementById('totalAssociateCount').textContent = totalAssociateCount.toLocaleString();
            redistributeAssociates();
            updateImpactAlerts();
        }

        function adjustCountryCount(countryCode, delta) {
            countryAssociateCounts[countryCode] = Math.max(0, (countryAssociateCounts[countryCode] || 1) + delta);
            document.getElementById(`count-${countryCode}`).textContent = countryAssociateCounts[countryCode];
            
            // Update total
            totalAssociateCount = Object.values(countryAssociateCounts).reduce((sum, count) => sum + count, 0);
            document.getElementById('totalAssociateCount').textContent = totalAssociateCount.toLocaleString();
            updateImpactAlerts();
        }

        function redistributeAssociates() {
            if (selectedCountries.size === 0) return;
            
            const baseCount = Math.floor(totalAssociateCount / selectedCountries.size);
            const remainder = totalAssociateCount % selectedCountries.size;
            
            let index = 0;
            selectedCountries.forEach(countryCode => {
                countryAssociateCounts[countryCode] = baseCount + (index < remainder ? 1 : 0);
                const element = document.getElementById(`count-${countryCode}`);
                if (element) {
                    element.textContent = countryAssociateCounts[countryCode];
                }
                index++;
            });
        }

        function updateImpactAlerts() {
            const alertsContainer = document.getElementById('impactAlerts');
            alertsContainer.innerHTML = '';
            
            if (totalAssociateCount >= 50) {
                const alert = document.createElement('div');
                alert.className = 'alert-callout';
                alert.innerHTML = `
                    <div class="alert-icon">⚠️</div>
                    <div>
                        <strong>WARN Act Consideration:</strong> With ${totalAssociateCount} associates impacted, you may need to comply with Worker Adjustment and Retraining Notification (WARN) Act requirements in the US, requiring 60 days advance notice for qualifying events.
                    </div>
                `;
                alertsContainer.appendChild(alert);
            }
        }

        function nextStep() {
            if (!canProceed()) return;
            
            if (currentStep < 4) {
                // Update step indicator - Remove active from current step
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.add('completed');
                
                // Update connector
                if (currentStep < 4) {
                    document.getElementById(`connector${currentStep}`).classList.add('completed');
                }
                
                // Hide current step content
                document.getElementById(`step${getStepName(currentStep)}`).classList.remove('active');
                
                currentStep++;
                
                // Show next step content
                document.getElementById(`step${getStepName(currentStep)}`).classList.add('active');
                
                // Update step indicator - Add active to new current step
                document.getElementById(`step${currentStep}`).classList.remove('pending');
                document.getElementById(`step${currentStep}`).classList.add('active');
                
                updateWizardTitle();
                updateNavigation();
                
                if (currentStep === 3) {
                    populateCountryBreakdown();
                    redistributeAssociates();
                }
                
                if (currentStep === 4) {
                    generateFinalResults();
                }
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                // Update step indicator - Remove active from current step
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.add('pending');
                
                // Hide current step content
                document.getElementById(`step${getStepName(currentStep)}`).classList.remove('active');
                
                currentStep--;
                
                // Update connector
                if (currentStep < 4) {
                    document.getElementById(`connector${currentStep}`).classList.remove('completed');
                }
                
                // Show previous step content
                document.getElementById(`step${getStepName(currentStep)}`).classList.add('active');
                
                // Update step indicator - Add active to previous step
                document.getElementById(`step${currentStep}`).classList.remove('completed');
                document.getElementById(`step${currentStep}`).classList.add('active');
                
                updateWizardTitle();
                updateNavigation();
            }
        }

        function getStepName(stepNumber) {
            const names = ['', 'Countries', 'ChangeTypes', 'Impact', 'Results'];
            return names[stepNumber];
        }

        function updateWizardTitle() {
            const titles = [
                '',
                'Step 1: Select Countries',
                'Step 2: Select Change Types',
                'Step 3: Impact Assessment',
                'Step 4: Review Guidance'
            ];
            document.getElementById('wizardTitle').textContent = titles[currentStep];
        }

        function canProceed() {
            switch(currentStep) {
                case 1: return selectedCountries.size > 0;
                case 2: return selectedChangeTypes.size > 0;
                case 3: return true;
                case 4: return false;
                default: return false;
            }
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentStep === 1;
            nextBtn.disabled = !canProceed();
            
            if (currentStep === 4) {
                nextBtn.textContent = 'Generate Report';
                nextBtn.disabled = true;
            } else {
                nextBtn.textContent = 'Next →';
            }
        }

        function generateFinalResults() {
            const resultsContainer = document.getElementById('finalResults');
            
            // Calculate overall metrics
            const overallRisk = calculateOverallRisk();
            const maxSLA = calculateMaxSLA();
            const canProceedGlobally = checkCanProceed();
            
            resultsContainer.innerHTML = `
                <div class="summary-cards">
                    <div class="summary-card">
                        <h3>Countries</h3>
                        <div class="value">${selectedCountries.size}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Change Types</h3>
                        <div class="value">${selectedChangeTypes.size}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Total Associates</h3>
                        <div class="value">${totalAssociateCount.toLocaleString()}</div>
                    </div>
                    <div class="summary-card">
                        <h3>Overall Risk</h3>
                        <div class="value">
                            <span class="risk-badge risk-${overallRisk.toLowerCase()}">${overallRisk}</span>
                        </div>
                    </div>
                    <div class="summary-card">
                        <h3>Max Timeline</h3>
                        <div class="value">${maxSLA} days</div>
                    </div>
                    <div class="summary-card">
                        <h3>Can Proceed</h3>
                        <div class="value" style="color: ${canProceedGlobally ? '#059669' : '#dc2626'}">
                            ${canProceedGlobally ? 'Yes' : 'No'}
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 12px; padding: 25px; border: 2px solid #e2e8f0; margin-top: 20px;">
                    <h3 style="margin-bottom: 20px; color: #1e293b;">📋 Executive Summary</h3>
                    <p>Your employment change scenario spans <strong>${selectedCountries.size} ${selectedCountries.size === 1 ? 'country' : 'countries'}</strong> and involves <strong>${selectedChangeTypes.size} ${selectedChangeTypes.size === 1 ? 'change type' : 'change types'}</strong> affecting <strong>${totalAssociateCount.toLocaleString()} ${totalAssociateCount === 1 ? 'associate' : 'associates'}</strong>.</p>
                    
                    <p style="margin-top: 15px;">Overall risk assessment: <span class="risk-badge risk-${overallRisk.toLowerCase()}">${overallRisk}</span></p>
                    
                    <p style="margin-top: 15px;"><strong>Key Recommendation:</strong> ${canProceedGlobally ? 'You may proceed with careful planning and proper documentation.' : 'Extensive legal review and approvals are required before proceeding.'} Allow up to ${maxSLA} days for full implementation across all jurisdictions.</p>
                </div>
                
                <h3 style="margin: 30px 0 20px 0; color: #1e293b;">🌍 Country-Specific Analysis</h3>
                <div class="country-results-grid">
                    ${generateCountryResults()}
                </div>
                
                <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 12px; padding: 20px; margin-top: 30px;">
                    <h4 style="color: #047857; margin-bottom: 10px;">✅ Next Steps</h4>
                    <ul style="margin: 0; padding-left: 20px; color: #047857;">
                        <li>Consult with legal counsel in each jurisdiction</li>
                        <li>Engage with local HR business partners</li>
                        <li>Prepare jurisdiction-specific documentation</li>
                        <li>Develop timeline accounting for longest SLA requirements</li>
                        <li>Establish clear communication plan for all stakeholders</li>
                    </ul>
                </div>
            `;
        }

        function generateCountryResults() {
            let html = '';
            
            selectedCountries.forEach(countryCode => {
                const country = countries.find(c => c.code === countryCode);
                const associateCount = countryAssociateCounts[countryCode] || 0;
                
                // Calculate country-specific metrics
                const countryRisks = Array.from(selectedChangeTypes).map(changeType => {
                    const change = employmentChanges.find(c => c.type === changeType);
                    return change.guidance[countryCode]?.riskLevel || 'Low';
                });
                
                const overallRisk = countryRisks.includes('High') ? 'High' : 
                                 countryRisks.includes('Medium') ? 'Medium' : 'Low';
                
                const maxSLA = getMaxSLAForCountry(countryCode);
                
                const canProceed = Array.from(selectedChangeTypes).some(changeType => {
                    const change = employmentChanges.find(c => c.type === changeType);
                    return change.guidance[countryCode]?.canProceed;
                });
                
                html += `
                    <div class="country-result-card">
                        <div class="country-result-header">
                            <span class="country-flag">${country.flag}</span>
                            <div class="country-result-title">${country.name}</div>
                            <span class="risk-badge risk-${overallRisk.toLowerCase()}">${overallRisk}</span>
                        </div>
                        
                        <div class="country-stats">
                            <div class="country-stat">
                                <div class="country-stat-label">Associates</div>
                                <div class="country-stat-value">${associateCount.toLocaleString()}</div>
                            </div>
                            <div class="country-stat">
                                <div class="country-stat-label">Max SLA</div>
                                <div class="country-stat-value">${maxSLA} days</div>
                            </div>
                            <div class="country-stat">
                                <div class="country-stat-label">Can Proceed</div>
                                <div class="country-stat-value" style="color: ${canProceed ? '#059669' : '#dc2626'}">
                                    ${canProceed ? 'Yes' : 'No'}
                                </div>
                            </div>
                            <div class="country-stat">
                                <div class="country-stat-label">% of Total</div>
                                <div class="country-stat-value">${Math.round((associateCount / totalAssociateCount) * 100)}%</div>
                            </div>
                        </div>
                        
                        <div style="font-size: 0.9rem; color: #64748b; line-height: 1.5;">
                            <strong>Legal Framework:</strong> ${country.laws}<br>
                            <strong>Complexity:</strong> ${country.complexity}
                        </div>
                    </div>
                `;
            });
            
            return html;
        }

        function calculateOverallRisk() {
            const risks = [];
            
            selectedCountries.forEach(countryCode => {
                selectedChangeTypes.forEach(changeType => {
                    const change = employmentChanges.find(c => c.type === changeType);
                    if (change.guidance[countryCode]) {
                        risks.push(change.guidance[countryCode].riskLevel);
                    }
                });
            });
            
            if (risks.includes('High')) return 'High';
            if (risks.includes('Medium')) return 'Medium';
            return 'Low';
        }

        function calculateMaxSLA() {
            let maxSLA = 0;
            
            selectedCountries.forEach(countryCode => {
                selectedChangeTypes.forEach(changeType => {
                    const change = employmentChanges.find(c => c.type === changeType);
                    if (change.guidance[countryCode]) {
                        maxSLA = Math.max(maxSLA, change.guidance[countryCode].slaDays);
                    }
                });
            });
            
            return maxSLA || 30;
        }

        function checkCanProceed() {
            return Array.from(selectedCountries).some(countryCode => {
                return Array.from(selectedChangeTypes).some(changeType => {
                    const change = employmentChanges.find(c => c.type === changeType);
                    return change.guidance[countryCode]?.canProceed;
                });
            });
        }

        // Make counter display editable
        document.getElementById('totalAssociateCount').onclick = function() {
            const current = this.textContent.replace(/,/g, '');
            const input = prompt('Enter total number of associates:', current);
            if (input && !isNaN(input) && input > 0) {
                totalAssociateCount = Math.min(10000, Math.max(1, parseInt(input)));
                this.textContent = totalAssociateCount.toLocaleString();
                redistributeAssociates();
                updateImpactAlerts();
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
